<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiktok/Kick Chat Reader</title>

    <meta name="description" content="A chat reader for TikTok LIVE utilizing TikTok-Live-Connector and Socket.IO to forward the data to the client. This demo project uses the unofficial TikTok API to retrieve chat comments, gifts and other events from TikTok LIVE.">
    <meta name="keywords" content="TikTok,Live,Livestream,Chat,Reader,Scraper,Tracker,tiktok.com,broadcast,api,library,node,node.js,javascript">

    <link rel="stylesheet" href="style.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script src="connection.js"></script>
    <script src="app.js"></script>
</head>
<body>
    <div class="head">
        <h1>Tiktok/Kick Chat Reader</h1>
        <div id="liveStatusContainer" style="display:flex;align-items:center;justify-content:center;gap:18px;margin-top:10px;">
            <div id="tiktokLiveStatus" style="display:flex;align-items:center;gap:6px;">
                <span class="live-dot" id="tiktokDot"></span>
                <span style="font-size:1em;">TikTok</span>
            </div>
            <div id="kickLiveStatus" style="display:flex;align-items:center;gap:6px;">
                <span class="live-dot" id="kickDot"></span>
                <span style="font-size:1em;">Kick</span>
            </div>
        </div>
    </div>

    <div class="description">
        
    </div>

    <div class="inputFields">
        <p>Enter the <b>@username</b> of a user who is currently live:</p>
        <input type="text" id="uniqueIdInput" placeholder="TikTok username (e.g. username)" autocomplete="off">
        <input type="button" id="connectButton" value="connect">
        <a href="#" onclick="generateOverlay()">Generate Overlay URL</a>
        <br>
        <p>Enter the <b>Kick channel name</b> (e.g. somechannel):</p>
        <input type="text" id="kickLinkInput" placeholder="Kick channel name (e.g. somechannel)" autocomplete="off">
        <input type="button" id="kickConnectButton" value="connect">
        <br>
    </div>
    <div id="kickStats"></div>

    <div id="roomStats">
      <div id="tiktokStats"></div>
    </div>

    <table class="splitchattable">
        <tr>
            <td>
                <div class="chatcontainer">
                    <h3 class="containerheader">Chats</h3>
                </div>
                <!-- Scroll to bottom button -->
                <button id="scrollToBottomBtn" style="position: fixed; bottom: 20px; right: 20px; background: #1db954; color: white; border: none; border-radius: 50%; width: 50px; height: 50px; font-size: 20px; cursor: pointer; display: none; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.3);" onclick="scrollToBottom()">â†“</button>
            </td>
        </tr>
    </table>
    <script>
function generateOverlay() {
    let tiktokUsername = $('#uniqueIdInput').val().trim();
    let kickChannel = $('#kickLinkInput').val().trim();

    let url = '/obs.html?';
    let params = [];

    if (tiktokUsername) {
        params.push('username=' + encodeURIComponent(tiktokUsername));
    }
    if (kickChannel) {
        params.push('kick=' + encodeURIComponent(kickChannel));
    }

    // Add your other overlay params as before
    params.push('showLikes=1');
    params.push('showChats=1');
    params.push('showGifts=1');
    params.push('showFollows=1');
    params.push('showJoins=1');
    params.push('bgColor=rgb(24,23,28)');
    params.push('fontColor=rgb(227,229,235)');
    params.push('fontSize=1.3em');

    if (tiktokUsername || kickChannel) {
        url += params.join('&');
        window.open(url, '_blank');
    } else {
        alert("Enter TikTok username or Kick channel name");
    }
}


</script>
</body>
</html>
